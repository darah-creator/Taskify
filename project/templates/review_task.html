{% extends "base.html" %}
{% load static %}

{% block title %}Review Task | Admin{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/admin_dashboard.css' %}">
<link rel="stylesheet" href="{% static 'css/review_form.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>Review Task</h2>

    <!-- Task Preview Card -->
    <div class="result-card">
        <div class="result-info">
            <h3>{{ task.title }}</h3>
            <p><strong>Assigned To:</strong> {{ task.user.username }}</p>
            <p><strong>Uploaded:</strong> {{ task.uploaded_at|date:"M d, Y" }}</p>
            <p><strong>Description:</strong> {{ task.description }}</p>

            {% if task.file %}
            <p><strong>Submitted File:</strong>
                <a href="{{ task.file.url }}" target="_blank">Download</a>
            </p>
            {% else %}
            <p><em>No file submitted yet.</em></p>
            {% endif %}

            <p><strong>Current Status:</strong>
                <span class="status {{ task.status|lower }}">{{ task.status|capfirst }}</span>
            </p>
        </div>
    </div>

    <!-- Review Form -->
    <form method="post" class="review-form">
        {% csrf_token %}

        <div class="form-group">
            <label for="grade">Grade (0-100)</label>
            <input type="number" name="grade" id="grade" min="0" max="100" value="{{ task.grade }}" class="input-field">
        </div>

        <div class="result-actions">
            <button type="submit" name="status" value="graded" class="btn success">Approve & Grade</button>
            <button type="submit" name="status" value="rejected" class="btn warning">Reject</button>
            <a href="{% url 'dashboard:admin_dashboard' %}" class="btn secondary">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}